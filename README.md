# Exploits for sbom.exe

The commands needed to run the the fingerprint phase and the agent.

## h2-console (CVE-2021-42392)

### `fingerprint`

```shell
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.jar jdk -o ./sb.jsonl
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.jar supply-chain -i ./sb1.jsonl -s ~/Desktop/chains/sbom.exe-poc/h2-console-2021-42392/src/main/resources/bom.json
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.jar runtime -i ./sb1.jsonl -mj h2-console-2021-42392 --cleanup -p /home/aman/Desktop/chains/sbom.exe-poc/   
```

### `agent`

```shell
 java -javaagent:/home/aman/Desktop/chains/sbom.exe/watchdog-agent/target/watchdog-agent-0.13.1-SNAPSHOT.jar=skipShutdown=false,sbom=sb1.jsonl -jar ~/Desktop/chains/sbom.exe-poc/h2-console-2021-42392/target/h2-console-2021-42392-1.0-SNAPSHOT.jar
```

## log4shell (CVE-2021-44228)

### `fingerprint`

```shell
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.jar jdk -o ./sb.jsonl
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.jar supply-chain -i ./sb.jsonl -s ../log4shell-poc/client/src/main/resources/bom.json
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.jar runtime -i ./sb.jsonl -mj log4shell-poc --cleanup -p /home/aman/Desktop/chains/log4shell-poc/client
```

### `agent`

```shell
java -javaagent:/home/aman/Desktop/chains/sbom.exe/watchdog-agent/target/watchdog-agent-0.13.1-SNAPSHOT.jar=skipShutdown=true,sbom=sb.jsonl -jar ../log4shell-poc/client/target/log4shell-poc-1.0-SNAPSHOT.jar
```

