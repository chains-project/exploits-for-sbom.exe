# Exploits for sbom.exe

The commands needed to run the the fingerprint phase and the agent.

## commons-configuration (CVE-2022-33980)

### `fingerprint`

```shell
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.jar jdk -o ./sb2.jsonl
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.
jar supply-chain -i ./sb2.jsonl -s rq2/commons-configuration-2022-33980/src/main/resources/bom.json
java -jar classfile-fingerprint/target/classfile-fingerprint-0.13.1-SNAPSHOT.
jar runtime -i ./sb2.jsonl -mj commons-configuration-2022-33980 --cleanup -p rq2/
```

### `agent`
```shell
java -javaagent:../../sbom.exe-artifacts/watchdog-agent-0.14.0-jar=skipShutdown=false,sbom=rq2/commons-configuration-2022-33980/index.jsonl @src/main/resources/payload.txt
```

## h2-console (CVE-2021-42392)

### `fingerprint`

```shell
java -jar ../../sbom.exe-artifacts/classfile-fingerprint-0.14.0.jar jdk -o ./sb.jsonl
java -jar ../../sbom.exe-artifacts/classfile-fingerprint-0.14.0.jar -i ./sb1.jsonl -s rq2/h2-console-2021-42392/src/main/resources/bom.json
java -jar ../../sbom.exe-artifacts/classfile-fingerprint-0.14.0.jar runtime 
-i ./sb1.jsonl -mj h2-console-2021-42392 --cleanup -p rq2 
```

### `agent`

```shell
 java -javaagent:../../sbom.exe-artifacts/watchdog-agent-0.14.0-jar=skipShutdown=false,sbom=sb1.jsonl -jar rq2/h2-console-2021-42392/target/h2-console-2021-42392-1.0-SNAPSHOT.jar
```

## log4shell (CVE-2021-44228)

### `fingerprint`

```shell
java -jar ../../sbom.exe-artifacts/classfile-fingerprint-0.14.0.jar jdk -o ./sb.jsonl
java -jar ../../sbom.exe-artifacts/classfile-fingerprint-0.14.0.jar supply-chain -i ./sb.jsonl -s ../log4shell-poc/client/src/main/resources/bom.json
java -jar ../../sbom.exe-artifacts/classfile-fingerprint-0.14.0.jar runtime -i ./sb.jsonl -mj log4shell-poc --cleanup -p rq2/log4shell-2021-44228
```

### `agent`

```shell
java -javaagent:../../sbom.exe-artifacts/watchdog-agent-0.14.0.jar=skipShutdown=true,sbom=sb.jsonl -jar ../log4shell-poc/client/target/log4shell-poc-1.0-SNAPSHOT.jar
```

## Starting up of the JNDI server

```shell
cd rogue-jndi
java -jar target/RogueJndi-1.1.jar --command "gedit /etc/passwd"
```

