#!/usr/bin/zsh

ABSOLUTE_PATH=$(realpath $0)
DIR_PATH=$(dirname $ABSOLUTE_PATH)
PATH_TO_AGENT="/home/aman/Desktop/chains/sbom.exe/watchdog-agent/target/watchdog-agent-0.13.1-SNAPSHOT.jar"
ARGS_FOR_AGENT="sbom=bomi.jsonl,skipShutdown=true"
PATH_TO_JAR="$DIR_PATH/ttorrent/cli/target/ttorrent-cli-1.5-shaded.jar"

temp_dir=$(mktemp -d)

trap "rm -rf $temp_dir" EXIT

check_for_exit_code() {
    if [ $1 -ne 0 ]; then
        echo "$3 " $2
        exit $1
    fi
}

java -javaagent:"${PATH_TO_AGENT}"="${ARGS_FOR_AGENT}" -jar ${PATH_TO_JAR} -o download_files --seed 0 test_folder.torrent

