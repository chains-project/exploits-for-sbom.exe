package org.example;

import org.openjdk.jmh.annotations.Benchmark;
import org.openjdk.jmh.annotations.BenchmarkMode;
import org.openjdk.jmh.annotations.Mode;


import javax.net.ssl.SSLParameters;
import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

public class Main {

    public static void main(String[] args) throws IOException {
        org.openjdk.jmh.Main.main(args);
    }

    @Benchmark
    @BenchmarkMode(Mode.All)
    public void graphhopper() throws Exception {
        SSLParameters sslParameters = new SSLParameters();
        sslParameters.setProtocols(new String[] {"TLSv1.2"});
        sslParameters.setNeedClientAuth(false);
        HttpClient client = HttpClient.newBuilder().sslParameters(sslParameters).build();

        String body = "{\"points\":[[13.4,52.55],[13.5,52.5]],\"profile\":\"car\",\"elevation\":true,\"instructions\":true,\"locale\":\"en_US\",\"points_encoded\":true,\"points_encoded_multiplier\":1000000,\"snap_preventions\":[\"ferry\"],\"details\":[\"road_class\",\"road_environment\",\"max_speed\",\"average_speed\"]}";

        HttpRequest request =
                HttpRequest.newBuilder().POST(HttpRequest.BodyPublishers.ofString(body)).header("Content-Type", "application/json").uri(URI.create("http://localhost:8989/route?key=")).build();
        client.send(request, HttpResponse.BodyHandlers.ofString());
    }

}